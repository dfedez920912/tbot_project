{% extends 'web_interface/base.html' %}
{% load static %}
{% block name%}<title>TBot Project | Logs</title>{%endblock%}
{% block title %}Logs del Sistema{% endblock %}

{% block content %}
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Registros del Sistema</h3>
      </div>

      <div class="card-body">
        <!-- Filtros -->
        <div class="row mb-3">
          <div class="col-md-3">
            <select id="filter-level" class="form-control form-control-sm">
              <option value="">Todos los niveles</option>
              {% for level, label in levels %}
              <option value="{{ level }}">{{ label }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-3">
            <select id="filter-source" class="form-control form-control-sm">
              <option value="">Todas las fuentes</option>
              {% for source in sources %}
              <option value="{{ source }}">{{ source }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-3">
            <input
              type="text"
              id="search-input"
              class="form-control form-control-sm"
              placeholder="Buscar en mensaje..."
            />
          </div>
          <div class="col-md-3">
            <button id="refresh-btn" class="btn btn-sm btn-primary">
              Actualizar
            </button>
            <button
              id="auto-refresh-toggle"
              class="btn btn-sm btn-outline-info"
            >
              Auto: ON
            </button>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-3">
            <input
              type="date"
              id="from-date"
              class="form-control form-control-sm"
            />
          </div>
          <div class="col-md-3">
            <input
              type="date"
              id="to-date"
              class="form-control form-control-sm"
            />
          </div>
          <div class="col-md-3">
            <select id="page-size" class="form-control form-control-sm">
              <option value="10">10 por página</option>
              <option value="25" selected>25 por página</option>
              <option value="50">50 por página</option>
              <option value="100">100 por página</option>
            </select>
          </div>
        </div>

        <!-- Tabla -->
        <div class="table-responsive">
          <table class="table table-hover table-sm">
            <thead>
              <tr>
                <th>Fecha/Hora</th>
                <th>Nivel</th>
                <th>Mensaje</th>
                <th>Fuente</th>
              </tr>
            </thead>
            <tbody id="logs-body">
              <!-- Llenado por AJAX -->
            </tbody>
          </table>
        </div>

        <!-- Paginación -->
        <nav aria-label="Paginación" class="mt-3">
          <ul
            class="pagination pagination-sm justify-content-center"
            id="pagination"
          >
            <!-- Llenado por AJAX -->
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>
{% endblock %}


{% block scripts %}
<script>
    // ← Definir la URL desde el template
    const LOGS_API_URL = '{% url "web_interface:logs" %}';
</script>
{% endblock %}
{% block custom_scripts %}
<script src="{% static 'web_interface/js/logs.js' %}"></script>
{% endblock %}